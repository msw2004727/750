<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D æˆ°å£«æ¨¡å‹å±•ç¤º</title>
    <style>
        /* CSS åŸºæœ¬è¨­å®šï¼Œè®“ 3D å ´æ™¯å¡«æ»¿æ•´å€‹è¦–çª— */
        body {
            margin: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #1a1a1a;
            color: #ffffff;
        }
        /* 3D ç•«å¸ƒ */
        #c {
            display: block;
            width: 100%;
            height: 100%;
        }
        /* è¼‰å…¥æç¤ºæ–‡å­—çš„æ¨£å¼ */
        #loading-screen {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            transition: opacity 0.5s;
        }
        /* ç‰ˆæ¬Šè³‡è¨Šçš„æ¨£å¼ */
        #info {
            position: absolute;
            bottom: 10px;
            width: 100%;
            text-align: center;
            padding: 5px;
            background-color: rgba(0, 0, 0, 0.5);
            font-size: 14px;
        }
        a {
            color: #87ceeb;
        }
    </style>
</head>
<body>
    <!-- 3D æ¸²æŸ“çš„ç•«å¸ƒ -->
    <canvas id="c"></canvas>

    <!-- è¼‰å…¥ç•«é¢ -->
    <div id="loading-screen">
        <div>âš”ï¸ è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</div>
    </div>

    <!-- ç‰ˆæ¬Šè³‡è¨Š -->
    <div id="info">
        æ¨¡å‹ä¾†æº: <a href="https://sketchfab.com/3d-models/knight-girl-d254288d716447829c42609029517173" target="_blank">"Knight Girl"</a> by anastasiaremeslennikova. Licensed under <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>

    <!-- å¼•å…¥ Three.js æ ¸å¿ƒå‡½å¼åº« -->
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.156.1/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.156.1/examples/jsm/"
        }
    }
    </script>

    <!-- ä¸»è¦çš„ JavaScript ç¨‹å¼ç¢¼ -->
    <script type="module">
        // å¾ three.js å¼•å…¥å¿…è¦çš„æ¨¡çµ„
        import * as THREE from 'three';
        // å¼•å…¥è®“æ”å½±æ©Ÿå¯ä»¥ç’°ç¹è§€å¯Ÿçš„æ§åˆ¶å™¨
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        // å¼•å…¥è¼‰å…¥ GLTF/GLB æ ¼å¼æ¨¡å‹çš„è¼‰å…¥å™¨
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

        // --- ä¸»è¦å‡½å¼ ---
        function main() {
            // å–å¾—ç•«å¸ƒå…ƒç´ 
            const canvas = document.querySelector('#c');
            // å–å¾—è¼‰å…¥ç•«é¢å…ƒç´ 
            const loadingScreen = document.getElementById('loading-screen');

            // å»ºç«‹æ¸²æŸ“å™¨ (Renderer)ï¼Œä¸¦é–‹å•Ÿåé‹¸é½’è®“é‚Šç·£æ›´å¹³æ»‘
            const renderer = new THREE.WebGLRenderer({
                canvas,
                antialias: true,
                alpha: true // å…è¨±èƒŒæ™¯é€æ˜
            });

            // --- æ”å½±æ©Ÿè¨­å®š ---
            const fov = 45; // è¦–é‡è§’åº¦ (Field of View)
            const aspect = window.innerWidth / window.innerHeight; // ç•«å¸ƒçš„é•·å¯¬æ¯”
            const near = 0.1; // æœ€è¿‘å¯è¦–è·é›¢
            const far = 100; // æœ€é å¯è¦–è·é›¢
            const camera = new THREE.PerspectiveCamera(fov, aspect, near, far);
            camera.position.set(2, 2, 5); // è¨­å®šæ”å½±æ©Ÿçš„åˆå§‹ä½ç½®

            // --- æ§åˆ¶å™¨è¨­å®š ---
            const controls = new OrbitControls(camera, canvas);
            controls.target.set(0, 1, 0); // è®“æ§åˆ¶å™¨åœç¹è‘—æ¨¡å‹çš„ä¸­å¿ƒé» (y=1 æ¯”è¼ƒç¬¦åˆäººå½¢ä¸­å¿ƒ)
            controls.update(); // æ›´æ–°æ§åˆ¶å™¨ç‹€æ…‹

            // --- å ´æ™¯è¨­å®š ---
            const scene = new THREE.Scene();
            
            // --- å…‰ç…§è¨­å®š ---
            // æ²’æœ‰å…‰ï¼Œæ¨¡å‹æœƒæ˜¯å…¨é»‘çš„
            {
                // 1. ç’°å¢ƒå…‰ (AmbientLight): æä¾›ä¸€å€‹åŸºç¤çš„ã€å‡å‹»çš„å…‰æºï¼Œè®“æ¨¡å‹æš—éƒ¨ä¸æœƒæ­»é»‘
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);

                // 2. åŠçƒå…‰ (HemisphereLight): å¾å ´æ™¯ä¸Šæ–¹å’Œä¸‹æ–¹ç™¼å‡ºä¸åŒé¡è‰²çš„å…‰ï¼Œæ¨¡æ“¬å¤©ç©ºå’Œåœ°é¢çš„åå…‰
                const skyColor = 0xB1E1FF;  // æ·¡è—è‰²å¤©ç©º
                const groundColor = 0xB97A20; // æ£•è‰²åœ°é¢
                const intensity = 1;
                const hemisphereLight = new THREE.HemisphereLight(skyColor, groundColor, intensity);
                scene.add(hemisphereLight);

                // 3. å®šå‘å…‰ (DirectionalLight): æ¨¡æ“¬å¤ªé™½å…‰ï¼Œæœ‰æ–¹å‘æ€§ï¼Œå¯ä»¥ç”¢ç”Ÿé™°å½±
                const color = 0xFFFFFF;
                const dirLight = new THREE.DirectionalLight(color, 2);
                dirLight.position.set(5, 10, 7.5); // è¨­å®šå…‰æºæ–¹å‘
                scene.add(dirLight);
            }

            // --- æ¨¡å‹è¼‰å…¥ ---
            {
                // å¯¦ä¾‹åŒ– GLTF è¼‰å…¥å™¨
                const gltfLoader = new GLTFLoader();
                // æ¨¡å‹æª”æ¡ˆçš„ URL
                const url = 'https://cdn.jsdelivr.net/gh/mrdoob/three.js@master/examples/models/gltf/Knight/Knight.gltf';

                // é–‹å§‹è¼‰å…¥æ¨¡å‹
                gltfLoader.load(url, (gltf) => {
                    // ç•¶æ¨¡å‹æˆåŠŸè¼‰å…¥å¾ŒåŸ·è¡Œçš„å›å‘¼å‡½å¼
                    const root = gltf.scene;
                    scene.add(root); // å°‡æ¨¡å‹åŠ å…¥åˆ°å ´æ™¯ä¸­

                    // éš±è—è¼‰å…¥ç•«é¢
                    loadingScreen.style.opacity = '0';
                    loadingScreen.addEventListener('transitionend', () => {
                        loadingScreen.style.display = 'none';
                    });

                },
                // (å¯é¸) è¼‰å…¥é€²åº¦å›å‘¼
                (xhr) => {
                    console.log((xhr.loaded / xhr.total * 100) + '% loaded');
                },
                // (å¯é¸) è¼‰å…¥éŒ¯èª¤å›å‘¼
                (error) => {
                    console.error('è¼‰å…¥æ¨¡å‹æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                    loadingScreen.innerText = 'ğŸ˜­ æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–æ§åˆ¶å°éŒ¯èª¤è¨Šæ¯ã€‚';
                });
            }

            // --- æ¸²æŸ“è¿´åœˆ ---
            function render() {
                // æª¢æŸ¥æ¸²æŸ“å™¨çš„ç•«å¸ƒå°ºå¯¸æ˜¯å¦èˆ‡å®¢æˆ¶ç«¯å°ºå¯¸åŒ¹é…
                const pixelRatio = window.devicePixelRatio;
                const width = canvas.clientWidth * pixelRatio | 0;
                const height = canvas.clientHeight * pixelRatio | 0;
                const needResize = canvas.width !== width || canvas.height !== height;
                if (needResize) {
                    // å¦‚æœéœ€è¦ï¼Œå°±é‡æ–°è¨­å®šæ¸²æŸ“å™¨å°ºå¯¸å’Œæ”å½±æ©Ÿé•·å¯¬æ¯”
                    renderer.setSize(width, height, false);
                    camera.aspect = canvas.clientWidth / canvas.clientHeight;
                    camera.updateProjectionMatrix();
                }

                // é€éæ”å½±æ©Ÿæ¸²æŸ“å ´æ™¯
                renderer.render(scene, camera);

                // è«‹æ±‚ç€è¦½å™¨åœ¨ä¸‹ä¸€å¹€ç¹¼çºŒå‘¼å« render å‡½å¼ï¼Œå½¢æˆå‹•ç•«è¿´åœˆ
                requestAnimationFrame(render);
            }

            // å•Ÿå‹•æ¸²æŸ“è¿´åœˆ
            requestAnimationFrame(render);
        }

        // åŸ·è¡Œä¸»å‡½å¼
        main();
    </script>
</body>
</html>
